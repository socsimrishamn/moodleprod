{"version":3,"sources":["../src/favorites.js"],"names":["define","$","Ajax","Notification","opts","debugjs","id","url","hash","setOptions","options","key","vartype","hasOwnProperty","debug","setDebug","isenabled","m","console","bind","window","i","favoritesModule","setUrl","data","title","confirm","M","util","get_string","request","call","methodname","args","optional","val","blockid","done","response","log","reload","fail","exception","remove","html","content","init","on","text","closest","parent","find","initialise","noConflict","document","ready"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Tested in Moodle 3.5\n *\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n *\n * @package moodle-block-user_favorites\n * @copyright 2018 MFreak.nl\n * @author    Luuk Verhoeven\n **/\n\n/* eslint no-unused-expressions: \"off\", no-console:off, no-invalid-this:\"off\",no-script-url:\"off\", block-scoped-var: \"off\" */\ndefine(['jquery', 'core/ajax', 'core/notification'], function($, Ajax, Notification) {\n\n    /**\n     * Opts that are possible to set.\n     *\n     * @type {{id: number, debugjs: boolean}}\n     */\n    var opts = {\n        debugjs: true,\n        id: 0,\n        url: '',\n        hash: ''\n    };\n\n    /**\n     * Set options base on listed options\n     * @param {object} options\n     */\n    var setOptions = function(options) {\n        \"use strict\";\n        var key, vartype;\n        for (key in opts) {\n            if (opts.hasOwnProperty(key) && options.hasOwnProperty(key)) {\n\n                // Casting to prevent errors.\n                vartype = typeof opts[key];\n                if (vartype === \"boolean\") {\n                    opts[key] = Boolean(options[key]);\n                } else if (vartype === 'number') {\n                    opts[key] = Number(options[key]);\n                } else if (vartype === 'string') {\n                    opts[key] = String(options[key]);\n                }\n                // Skip all other types.\n            }\n        }\n    };\n\n    /**\n     * Console log debug wrapper.\n     */\n    var debug = {};\n\n    /**\n     * Set debug mode\n     * Should only be enabled if site is in debug mode.\n     * @param {boolean} isenabled\n     */\n    var setDebug = function(isenabled) {\n\n        if (isenabled) {\n            for (var m in console) {\n                if (typeof console[m] == 'function') {\n                    debug[m] = console[m].bind(window.console);\n                }\n            }\n        } else {\n\n            // Fake wrapper.\n            for (var i in console) {\n                if (typeof console[i] == 'function') {\n                    debug[i] = function() {\n                        // Don't do anything.\n                    };\n                }\n            }\n        }\n    };\n\n    var favoritesModule = {\n\n        /**\n         * Add or update a url\n         *\n         * @param {object} data\n         * @param {string} title\n         */\n        setUrl: function(data, title) {\n\n            Notification.confirm(M.util.get_string('javascript:set_title', 'block_user_favorites'),\n                '<input class=\"form-control\" id=\"favorite-url\" value=\"' + title + '\">',\n                M.util.get_string('javascript:yes', 'block_user_favorites'),\n                M.util.get_string('javascript:no', 'block_user_favorites'), function() {\n\n                    var request = Ajax.call([{\n                        methodname: 'block_user_favorites_set_url',\n                        args: {\n                            hash: data.hash,\n                            optional : {\n                                url: data.url,\n                            },\n                            title: $('#favorite-url').val(),\n                            blockid: opts.id,\n                        }\n                    }]);\n\n                    request[0].done(function(response) {\n                        debug.log(response);\n                        favoritesModule.reload();\n                    }).fail(Notification.exception);\n                });\n        },\n\n        /**\n         * Delete a url\n         *\n         * @param {object} data\n         */\n        remove: function(data) {\n\n            var request = Ajax.call([{\n                methodname: 'block_user_favorites_delete_url',\n                args: {\n                    hash: data.hash,\n                    blockid: opts.id,\n                }\n            }]);\n\n            request[0].done(function(response) {\n                debug.log(response);\n                favoritesModule.reload();\n            }).fail(Notification.exception);\n        },\n\n        /**\n         * Reload the block\n         */\n        reload: function() {\n\n            var request = Ajax.call([{\n                methodname: 'block_user_favorites_content',\n                args: {\n                    url: opts.url,\n                    blockid: opts.id,\n                }\n            }]);\n\n            request[0].done(function(response) {\n                debug.log(response);\n                $('.block_user_favorites .content').html(response.content);\n            }).fail(Notification.exception);\n        },\n\n        /**\n         * Init event triggers.\n         */\n        init: function() {\n\n            $('.block_user_favorites').on('click', '#block_user_favorites_set', function() {\n                // Set current as favorite.\n                favoritesModule.setUrl({\n                    'hash': opts.hash,\n                    'url': opts.url\n                }, $('title').text());\n\n            }).on('click', '#block_user_favorites_delete', function() {\n                // Delete current pages from favorites.\n                favoritesModule.remove({\n                    'hash': opts.hash,\n                });\n\n            }).on('click', '.fa-remove', function() {\n                // Remove a fav in the list.\n                favoritesModule.remove($(this).closest('li').data());\n\n            }).on('click', '.fa-edit', function() {\n                // Edit a fav int the list.\n                var data = $(this).parent().parent().data();\n                favoritesModule.setUrl(data, $(this).parent().parent().find('a').text());\n            });\n        }\n    };\n\n    return {\n        /**\n         * Init\n         *\n         * @param {object} args\n         */\n        initialise: function(args) {\n\n            // Load the args passed from PHP.\n            setOptions(args);\n\n            // Set internal debug console.\n            setDebug(opts.debugjs);\n\n            $.noConflict();\n            $(document).ready(function() {\n                debug.log('Block User Favorites v1.2');\n                favoritesModule.init();\n            });\n        }\n    };\n});"],"file":"favorites.min.js"}